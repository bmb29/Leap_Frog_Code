function Dimer_Eq_of_M(du, u, p, t)    
    du[1] = (-4) * (2 + u[3]^2 + (-2) * 2^(1 / 2) * u[4] + u[4]^2 + 2 * u[3] * ((-1) * 2^(1 / 2) + u[4])   + (u[1] + (-1) * u[2])^2)^(-2) * (2 + u[3]^2 + 2 * 2^(1 / 2) * u[4] + u[4]^2 + 2 * u[3] * (   2^(1 / 2) + u[4]) + (u[1] + (-1) * u[2])^2)^(-2) * (u[4]^2 + u[2]^2) * (2 + u[3]^2 + 2 *   u[3] * (2^(1 / 2) + (-1) * u[4]) + (-2) * 2^(1 / 2) * u[4] + u[4]^2 + (u[1] + u[2])^2)^(-2)     *(2 + u[3]^2 + 2 * 2^(1 / 2) * u[4] + u[4]^2 + (-2) * u[3] * (2^(1 / 2) + u[4]) + (u[1] + u[2])^2)^(-2) * ((u[3]^2 + u[1]^2) * (2 + (-2) * 2^(1 / 2) * (u[3] + u[4]) + (u[3] + u[4])^2 +   (u[1] + (-1) * u[2])^2)^(-1) * (2 + 2 * 2^(1 / 2) * (u[3] + u[4]) + (u[3] + u[4])^2 + (u[1] + (  -1) * u[2])^2)^(-1) * (u[4]^2 + u[2]^2) * (2 + 2 * 2^(1 / 2) * (u[3] + (-1) * u[4]) + (   u[3] + (-1) * u[4])^2 + (u[1] + u[2])^2)^(-1) * (2 + (u[3] + (-1) * u[4])^2 + 2 * 2^(1 / 2)   * ((-1) * u[3] + u[4]) + (u[1] + u[2])^2)^(-1))^(-1 / 2) * (3 * u[3]^9 + 24 * u[3]^6 *   u[4] * u[1] * u[2] + 4 * u[3]^7 * ((-4) + (-2) * u[4]^2 + 3 * u[1]^2 + 2 * u[2]^2) + 8 *   u[3]^4 * u[4] * u[1] * u[2] * (4 + (-2) * u[4]^2 + 7 * u[1]^2 + 2 * u[2]^2) + 4 * u[3]^3 *   u[1]^2 * (12 + 3 * u[4]^4 + 3 * u[1]^4 + (-4) * u[2]^2 + 3 * u[2]^4 + 2 * u[1]^2 * ((-2) +   u[2]^2) + (-2) * u[4]^2 * ((-2) + u[1]^2 + u[2]^2)) + 8 * u[4] * u[1]^3 * u[2] * (u[4]^4 + (   u[1]^2 + (-1) * u[2]^2)^2 + 2 * u[4]^2 * (2 + u[1]^2 + u[2]^2) + (-4) * (3 + u[1]^2 +   u[2]^2)) + 2 * u[3]^5 * (12 + 3 * u[4]^4 + 9 * u[1]^4 + (-4) * u[2]^2 + 3 * u[2]^4 + 8 *   u[1]^2 * ((-2) + u[2]^2) + (-2) * u[4]^2 * ((-2) + 4 * u[1]^2 + u[2]^2)) + (-8) *   u[3]^2 * u[4] * u[1] * u[2] * (u[4]^4 + (-5) * u[1]^4 + u[2]^4 + (-8) * u[1]^2 * (2 + u[2]^2)   + (-4) * (3 + u[2]^2) + 2 * u[4]^2 * (2 + 4 * u[1]^2 + u[2]^2)) + u[3] * ((-1) * u[4]^8 +  3 * u[1]^8 + 8 * u[1]^2 * ((-2) + u[2]^2) * (2 + u[2]^2)^2 + (-1) * (2 + u[2]^2)^4 + (  -4) * u[4]^6 * ((-2) + 2 * u[1]^2 + u[2]^2) + (-2) * u[1]^4 * (20 + 36 * u[2]^2 + 5 *   u[2]^4) + (-2) * u[4]^4 * (12 + 5 * u[1]^4 + (-4) * u[2]^2 + 3 * u[2]^4 + 4 * u[1]^2 * ((  -2) + u[2]^2)) + 4 * u[4]^2 * ((-1) * ((-2) + u[2]^2) * (2 + u[2]^2)^2 + u[1]^4 * (  18 + 23 * u[2]^2) + 2 * u[1]^2 * (4 + 20 * u[2]^2 + u[2]^4))));
    du[2] = 4 * (u[3]^2 + u[1]^2) * (2 + u[3]^2 + (-2) * 2^(1 / 2) * u[4] + u[4]^2 + 2 * u[3] * ((-1) *   2^(1 / 2) + u[4]) + (u[1] + (-1) * u[2])^2)^(-2) * (2 + u[3]^2 + 2 * 2^(1 / 2) * u[4] +   u[4]^2 + 2 * u[3] * (2^(1 / 2) + u[4]) + (u[1] + (-1) * u[2])^2)^(-2) * (2 + u[3]^2 + 2 *   u[3] * (2^(1 / 2) + (-1) * u[4]) + (-2) * 2^(1 / 2) * u[4] + u[4]^2 + (u[1] + u[2])^2)^(-2)     *(2 + u[3]^2 + 2 * 2^(1 / 2) * u[4] + u[4]^2 + (-2) * u[3] * (2^(1 / 2) + u[4]) + (u[1] + u[2])^2)^(-2) * ((u[3]^2 + u[1]^2) * (2 + (-2) * 2^(1 / 2) * (u[3] + u[4]) + (u[3] + u[4])^2 +   (u[1] + (-1) * u[2])^2)^(-1) * (2 + 2 * 2^(1 / 2) * (u[3] + u[4]) + (u[3] + u[4])^2 + (u[1] + (   -1) * u[2])^2)^(-1) * (u[4]^2 + u[2]^2) * (2 + 2 * 2^(1 / 2) * (u[3] + (-1) * u[4]) + (   u[3] + (-1) * u[4])^2 + (u[1] + u[2])^2)^(-1) * (2 + (u[3] + (-1) * u[4])^2 + 2 * 2^(1 / 2)   * ((-1) * u[3] + u[4]) + (u[1] + u[2])^2)^(-1))^(-1 / 2) * ((-3) * u[4]^9 + (-24) *   u[3] * u[4]^6 * u[1] * u[2] + 8 * u[3] * u[4]^4 * u[1] * u[2] * ((-4) + 2 * u[3]^2 + (-2) *   u[1]^2 + (-7) * u[2]^2) + 4 * u[4]^7 * (4 + 2 * u[3]^2 + (-2) * u[1]^2 + (-3) * u[2]^2) +   u[4] * ((u[3]^4 + 2 * u[3]^2 * ((-2) + u[1]^2) + (2 + u[1]^2)^2)^2 + 8 * (u[3]^6 +   u[3]^4 * ((-2) + u[1]^2) + (-1) * ((-2) + u[1]^2) * (2 + u[1]^2)^2 + (-1) * u[3]^2 *   (4 + 20 * u[1]^2 + u[1]^4)) * u[2]^2 + 2 * (20 + 5 * u[3]^4 + 36 * u[1]^2 + 5 * u[1]^4 + (   -2) * u[3]^2 * (18 + 23 * u[1]^2)) * u[2]^4 + (-3) * u[2]^8) + (-4) * u[4]^3 *   u[2]^2 * (12 + 3 * u[3]^4 + (-4) * u[1]^2 + 3 * u[1]^4 + 2 * ((-2) + u[1]^2) * u[2]^2 +   3 * u[2]^4 + (-2) * u[3]^2 * ((-2) + u[1]^2 + u[2]^2)) + (-8) * u[3] * u[1] * u[2]^3 * (   u[3]^4 + (u[1]^2 + (-1) * u[2]^2)^2 + 2 * u[3]^2 * (2 + u[1]^2 + u[2]^2) + (-4) * (3 +   u[1]^2 + u[2]^2)) + (-2) * u[4]^5 * (12 + 3 * u[3]^4 + (-4) * u[1]^2 + 3 * u[1]^4 + 8 * ((   -2) + u[1]^2) * u[2]^2 + 9 * u[2]^4 + (-2) * u[3]^2 * ((-2) + u[1]^2 + 4 * u[2]^2)) + 8 *   u[3] * u[4]^2 * u[1] * u[2] * ((-12) + u[3]^4 + (-4) * u[1]^2 + u[1]^4 + (-8) * (2 + u[1]^2)   * u[2]^2 + (-5) * u[2]^4 + 2 * u[3]^2 * (2 + u[1]^2 + 4 * u[2]^2)));
    du[4] = 4 * (2 + u[3]^2 + (-2) * 2^(1 / 2) * u[4] + u[4]^2 + 2 * u[3] * ((-1) * 2^(1 / 2) + u[4]) + ( u[1] + (-1) * u[2])^2)^(-2) * (2 + u[3]^2 + 2 * 2^(1 / 2) * u[4] + u[4]^2 + 2 * u[3] * ( 2^(1 / 2) + u[4]) + (u[1] + (-1) * u[2])^2)^(-2) * (u[4]^2 + u[2]^2) * (2 + u[3]^2 + 2 * u[3] * (2^(1 / 2) + (-1) * u[4]) + (-2) * 2^(1 / 2) * u[4] + u[4]^2 + (u[1] + u[2])^2)^(-2)     *(2 + u[3]^2 + 2 * 2^(1 / 2) * u[4] + u[4]^2 + (-2) * u[3] * (2^(1 / 2) + u[4]) + (u[1] + u[2])^2)^(-2) * ((u[3]^2 + u[1]^2) * (2 + (-2) * 2^(1 / 2) * (u[3] + u[4]) + (u[3] + u[4])^2 + (u[1] + (-1) * u[2])^2)^(-1) * (2 + 2 * 2^(1 / 2) * (u[3] + u[4]) + (u[3] + u[4])^2 + (u[1] + ( -1) * u[2])^2)^(-1) * (u[4]^2 + u[2]^2) * (2 + 2 * 2^(1 / 2) * (u[3] + (-1) * u[4]) + ( u[3] + (-1) * u[4])^2 + (u[1] + u[2])^2)^(-1) * (2 + (u[3] + (-1) * u[4])^2 + 2 * 2^(1 / 2) * ((-1) * u[3] + u[4]) + (u[1] + u[2])^2)^(-1))^(-1 / 2) * (3 * u[1]^9 + 24 * u[3] * u[4] *u[1]^6 * u[2] + 4 * u[1]^7 * (4 + 3 * u[3]^2 + 2 * u[4]^2 + (-2) * u[2]^2) + 8 * u[3] * u[4] * u[1]^4 * u[2] * ((-4) + 7 * u[3]^2 + 2 * u[4]^2 + (-2) * u[2]^2) + 4 * u[3]^2 * u[1]^3 * ( 12 + 3 * u[3]^4 + 4 * u[4]^2 + 3 * u[4]^4 + (-2) * (2 + u[4]^2) * u[2]^2 + 3 * u[2]^4 + 2 * u[3]^2 * (2 + u[4]^2 + (-1) * u[2]^2)) + 2 * u[1]^5 * (12 + 9 * u[3]^4 + 4 * u[4]^2 + 3 * u[4]^4 + (-2) * (2 + u[4]^2) * u[2]^2 + 3 * u[2]^4 + 8 * u[3]^2 * (2 + u[4]^2 + (-1) * u[2]^2)) + 8 * u[3] * u[4] * u[1]^2 * u[2] * (5 * u[3]^4 + 8 * u[3]^2 * ((-2) + u[4]^2 + (-1) * u[2]^2) + 4 * (3 + (-1) * u[4]^2 + u[2]^2) + (-1) * (u[4]^2 + u[2]^2)^2) + 8 * u[3]^3 * u[4] * u[2] * (u[3]^4 + 4 * ((-3) + u[4]^2 + (-1) * u[2]^2) + 2 * u[3]^2 * (2 + ( -1) * u[4]^2 + u[2]^2) + (u[4]^2 + u[2]^2)^2) + u[1] * (3 * u[3]^8 + (-1) * (u[4]^4 + 2 * u[4]^2 * ((-2) + u[2]^2) + (2 + u[2]^2)^2)^2 + (-2) * u[3]^4 * (20 + 5 * u[4]^4 + 36 * u[2]^2 + 5 * u[2]^4 + (-2) * u[4]^2 * (18 + 23 * u[2]^2)) + 8 * u[3]^2 * (u[4]^6 + u[4]^4 * ((-2) + u[2]^2) + (-1) * ((-2) + u[2]^2) * (2 + u[2]^2)^2 + (-1) * u[4]^2 * (4 + 20 * u[2]^2 + u[2]^4))));
    du[3] = (-4) * (u[3]^2 + u[1]^2) * (2 + u[3]^2 + (-2) * 2^(1 / 2) * u[4] + u[4]^2 + 2 * u[3] * (( -1) * 2^(1 / 2) + u[4]) + (u[1] + (-1) * u[2])^2)^(-2) * (2 + u[3]^2 + 2 * 2^(1 / 2) * u[4] + u[4]^2 + 2 * u[3] * (2^(1 / 2) + u[4]) + (u[1] + (-1) * u[2])^2)^(-2) * ((-8) * u[3] * u[4]^3 * u[1] * (u[3]^4 + 4 * ((-3) + u[4]^2 + (-1) * u[1]^2) + 2 * u[3]^2 * (2 + (-1) * u[4]^2 + u[1]^2) + (u[4]^2 + u[1]^2)^2) + (u[3]^8 + (-3) * u[4]^8 + 8 * u[4]^2 * ((-2) + u[1]^2) * (2 + u[1]^2)^2 + (2 + u[1]^2)^4 + 4 * u[3]^6 * ((-2) + (-2) * u[4]^2 + u[1]^2) + 2 * u[3]^4 * (12 + 8 * u[4]^2 + 5 * u[4]^4 + (-4) * (1 + u[4]^2) * u[1]^2 + 3 * u[1]^4) + 2 * u[4]^4 * (20 + 36 * u[1]^2 + 5 * u[1]^4) + 4 * u[3]^2 * (((-2) + u[1]^2) * (2 + u[1]^2)^2 + (-1) * u[4]^4 * (18 + 23 * u[1]^2) + 2 * u[4]^2 * (4 + 20 * u[1]^2 + u[1]^4))) * u[2] + 8 * u[3] * u[4] * u[1] * (u[3]^4 + (-5) * u[4]^4 + u[1]^4 + 8 * u[4]^2 * (2 + u[1]^2) + (-4) * (3 + u[1]^2) + 2 * u[3]^2 * (2 + (-4) * u[4]^2 + u[1]^2)) * u[2]^2 + ( -4) * u[4]^2 * (12 + 3 * u[3]^4 + 4 * u[4]^2 + 3 * u[4]^4 + (-2) * (2 + u[4]^2) * u[1]^2 + 3 * u[1]^4 + 2 * u[3]^2 * (2 + u[4]^2 + (-1) * u[1]^2)) * u[2]^3 + (-8) * u[3] * u[4] * u[1] * (2 * u[3]^2 + 7 * u[4]^2 + (-2) * (2 + u[1]^2)) * u[2]^4 + (-2) * (12 + 3 * u[3]^4 + 9 * u[4]^4 + (-4) * u[1]^2 + 3 * u[1]^4 + u[3]^2 * (4 + 8 * u[4]^2 + (-2) * u[1]^2) + (-8) * u[4]^2 * ((-2) + u[1]^2)) * u[2]^5 + (-24) * u[3] * u[4] * u[1] * u[2]^6 + (-4) * (4 + 2 * u[3]^2 + 3 * u[4]^2 + (-2) * u[1]^2) * u[2]^7 + (-3) * u[2]^9) * (2 + u[3]^2 + 2 * u[3] * (2^(1 / 2) + (-1) * u[4]) + (-2) * 2^(1 / 2) * u[4] + u[4]^2 + (u[1] + u[2])^2)^(-2)     *(2 + u[3]^2 + 2 * 2^(1 / 2) * u[4] + u[4]^2 + (-2) * u[3] * (2^(1 / 2) + u[4]) + (u[1] + u[2])^2)^(-2) * ((u[3]^2 + u[1]^2) * (2 + (-2) * 2^(1 / 2) * (u[3] + u[4]) + (u[3] + u[4])^2 + (u[1] + (-1) * u[2])^2)^(-1) * (2 + 2 * 2^(1 / 2) * (u[3] + u[4]) + (u[3] + u[4])^2 + (u[1] + ( -1) * u[2])^2)^(-1) * (u[4]^2 + u[2]^2) * (2 + 2 * 2^(1 / 2) * (u[3] + (-1) * u[4]) + ( u[3] + (-1) * u[4])^2 + (u[1] + u[2])^2)^(-1) * (2 + (u[3] + (-1) * u[4])^2 + 2 * 2^(1 / 2) * ((-1) * u[3] + u[4]) + (u[1] + u[2])^2)^(-1))^(-1 / 2);
    du[5] = 0
    du[6] = 0
end





# Hamiltonian_Dimer(q,p,t)=4sqrt(abs( (q[1]^2+p[1]^2)*(q[2]^2+p[2]^2) )/
# (
#         (2-2sqrt(2)*(p[1]+p[2])+(p[1]+p[2])^2+(q[1]-q[2])^2 )*
#         (2+2sqrt(2)*(p[1]+p[2])+(p[1]+p[2])^2+(q[1]-q[2])^2 )*
#         (2-2sqrt(2)*(p[1]-p[2])+(p[1]-p[2])^2+(q[1]+q[2])^2 )*
#         (2+2sqrt(2)*(p[1]-p[2])+(p[1]-p[2])^2+(q[1]+q[2])^2 )

# ));
# function Dimer_Eq_of_M(du, u, p, t)
#     Q=[u[1],u[2]]; P=[u[3],u[4]];
#     Ham=Hamiltonian_Dimer(Q,P,0);
#     du[1]=Ham*(u[3]*(u[3]^2+u[1]^2)^(-1)+(-2)*(u[3]+u[3])*(u[3]^4+4*u[3]^3*u[3]+u[3]^4+ 2*u[3]^2*((-2)+(u[1]+(-1)*u[2])^2)+(2+(u[1]+(-1)*u[2])^2)^2+4*u[3]* u[3]*((-2)+u[3]^2+(u[1]+(-1)*u[2])^2)+2*u[3]^2*((-2)+3*u[3]^2+(u[1]+(-1)*u[2])^2))^(-1)*((-2)+(u[3]+u[3])^2+(u[1]+(-1)*u[2])^2)+(-2)*(u[3]+ (-1)*u[3])*((-2)+(u[3]+(-1)*u[3])^2+(u[1]+u[2])^2)*(u[3]^4+(-4)* u[3]^3*u[3]+u[3]^4+2*u[3]^2*((-2)+(u[1]+u[2])^2)+(2+(u[1]+u[2])^2)^2+(-4) *u[3]*u[3]*((-2)+u[3]^2+(u[1]+u[2])^2)+2*u[3]^2*((-2)+3*u[3]^2+(u[1]+u[2]) ^2))^(-1));
#     du[2]=Ham*((2+u[3]^2+(-2)*2^(1/2)*u[3]+u[3]^2+2*u[3]*((-1)*2^(1/2)+u[3])+(u[1]+(-1)*u[2])^2)^(-1)*(2+u[3]^2+2*2^(1/2)*u[3]+u[3]^2+2*u[3]*(2^(1/2)+u[3])+(u[1]+(-1)*u[2])^2)^(-1)*(u[3]^2+u[2]^2)^(-1)*(2+u[3]^2+  2*u[3]*(2^(1/2)+(-1)*u[3])+(-2)*2^(1/2)*u[3]+u[3]^2+(u[1]+u[2])^2)^(  -1)*(2+u[3]^2+2*2^(1/2)*u[3]+u[3]^2+(-2)*u[3]*(2^(1/2)+u[3])+(u[1]+  u[2])^2)^(-1)*((-3)*u[3]^9+(-24)*u[3]*u[3]^6*u[1]*u[2]+8*u[3]*u[3]^4*u[1]*u[2]*((-4)+2*u[3]^2+(-2)*u[1]^2+(-7)*u[2]^2)+4*u[3]^7*(4+2*u[3]^2+(-2)*u[1]^2+(-3)*u[2]^2)+u[3]*((u[3]^4+2*u[3]^2*((-2)+   u[1]^2)+(2+u[1]^2)^2)^2+8*(u[3]^6+u[3]^4*((-2)+u[1]^2)+(-1)*((-2)+ u[1]^2)*(2+u[1]^2)^2+(-1)*u[3]^2*(4+20*u[1]^2+u[1]^4))*u[2]^2+2*( 20+5*u[3]^4+36*u[1]^2+5*u[1]^4+(-2)*u[3]^2*(18+23*u[1]^2))*  u[2]^4+(-3)*u[2]^8)+(-4)*u[3]^3*u[2]^2*(12+3*u[3]^4+(-4)*u[1]^2+ 3*u[1]^4+2*((-2)+u[1]^2)*u[2]^2+3*u[2]^4+(-2)*u[3]^2*((-2)+u[1]^2+  u[2]^2))+(-8)*u[3]*u[1]*u[2]^3*(u[3]^4+(u[1]^2+(-1)*u[2]^2)^2+2* u[3]^2*(2+u[1]^2+u[2]^2)+(-4)*(3+u[1]^2+u[2]^2))+(-2)*u[3]^5*(12+3* u[3]^4+(-4)*u[1]^2+3*u[1]^4+8*((-2)+u[1]^2)*u[2]^2+9*u[2]^4+(-2)* u[3]^2*((-2)+u[1]^2+4*u[2]^2))+8*u[3]*u[3]^2*u[1]*u[2]*((-12)+u[3]^4+(-4)*u[1]^2+u[1]^4+(-8)*(2+u[1]^2)*u[2]^2+(-5)*u[2]^4+2*u[3]^2*(2+  u[1]^2+4*u[2]^2))));
#     du[3]=Ham*((-1)*u[1]*(u[3]^2+u[1]^2)^(-1)+2*(u[3]^4+4*u[3]^3*u[3]+u[3]^4+2* u[3]^2*((-2)+(u[1]+(-1)*u[2])^2)+(2+(u[1]+(-1)*u[2])^2)^2+4*u[3]*u[3]*  ((-2)+u[3]^2+(u[1]+(-1)*u[2])^2)+2*u[3]^2*((-2)+3*u[3]^2+(u[1]+(-1)*  u[2])^2))^(-1)*(2+(u[3]+u[3])^2+(u[1]+(-1)*u[2])^2)*(u[1]+(-1)*u[2])+2*(u[1]+u[2])*(2+(u[3]+(-1)*u[3])^2+(u[1]+u[2])^2)*(u[3]^4+(-4)*u[3]^3*u[3]+u[3]^4+2*u[3]^2*((-2)+(u[1]+u[2])^2)+(2+(u[1]+u[2])^2)^2+(-4)*u[3]*u[3]*((-2)+u[3]^2+(u[1]+u[2])^2)+2*u[3]^2*((-2)+3*u[3]^2+(u[1]+u[2])^2))^( -1));
#     du[4]=Ham*((2+u[3]^2+(-2)*2^(1/2)*u[3]+u[3]^2+2*u[3]*((-1)*2^(1/2)+u[3])+(u[1]+(-1)*u[2])^2)^(-1)*((-1)*u[1]+u[2])+(2+u[3]^2+2*2^(1/2)*u[3]+u[3]^2+  2*u[3]*(2^(1/2)+u[3])+(u[1]+(-1)*u[2])^2)^(-1)*((-1)*u[1]+u[2])+(-1)*  u[2]*(u[3]^2+u[2]^2)^(-1)+(u[1]+u[2])*(2+u[3]^2+2*u[3]*(2^(1/2)+(-1)* u[3])+(-2)*2^(1/2)*u[3]+u[3]^2+(u[1]+u[2])^2)^(-1)+(u[1]+u[2])*(2+u[3]^2+ 2*2^(1/2)*u[3]+u[3]^2+(-2)*u[3]*(2^(1/2)+u[3])+(u[1]+u[2])^2)^(-1));
#     du[5]=0
#     du[6]=0
# end